pool:
  vmImage: 'vs2017-win2016'
  
variables:
  buildConfiguration: 'Release'

steps:
- task: DotNetCoreInstaller@0
  displayName: 'Use .NET Core SDK Tool Installer'
  inputs:
    version: 2.2.100
# ironmunge
- script: |
    dotnet build   ironmunge.sln --configuration $(buildConfiguration)                                --output $(Build.BinariesDirectory)
  displayName: 'dotnet build $(buildConfiguration)'
- script: |
    dotnet publish ironmunge.sln --configuration $(buildConfiguration) --no-build                     --output $(Build.ArtifactStagingDirectory)/pub/net
    dotnet publish ironmunge.sln --configuration $(buildConfiguration) --no-build --runtime win       --output $(Build.ArtifactStagingDirectory)/pub/win
    dotnet publish ironmunge.sln --configuration $(buildConfiguration) --no-build --runtime osx-x64   --output $(Build.ArtifactStagingDirectory)/pub/mac
    dotnet publish ironmunge.sln --configuration $(buildConfiguration) --no-build --runtime linux-x64 --output $(Build.ArtifactStagingDirectory)/pub/nix
- task: PublishBuildArtifacts@1
  inputs:
    pathtoPublish: $(Build.ArtifactStagingDirectory)/pub/net
    ArtifactName: 'pub-net'
- task: PublishBuildArtifacts@1
  inputs:
    pathtoPublish: $(Build.ArtifactStagingDirectory)/pub/win
    ArtifactName: 'pub-win'
- task: PublishBuildArtifacts@1
  inputs:
    pathtoPublish: $(Build.ArtifactStagingDirectory)/pub/mac
    ArtifactName: 'pub-mac'
- task: PublishBuildArtifacts@1
  inputs:
    pathtoPublish: $(Build.ArtifactStagingDirectory)/pub/nix
    ArtifactName: 'pub-nix'
